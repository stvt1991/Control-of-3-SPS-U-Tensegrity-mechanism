/*
	*  calc.c
	*
	* COPYRIGHTS: Swaminath VENKATESWARAN, Damien CHABLAT, LS2N, Centrale Nantes, France
	* Date de cr√©ation: 03/07/2020
	* Date de modification: 06/08/2020
	*
*/
 
#include "calc.h"

 
void values(float eta_c, float etad_c, float etadd_c, float phi_c, float phid_c, float phidd_c, float *theta1, float *theta2, float *theta3, float *theta1d, float *theta2d, float *theta3d, float *theta1dd, float *theta2dd, float *theta3dd)

{
	float l1,l2,l3,l1d,l2d,l3d,v1,v2,v3,a1,a2,a3;
	
	l1 = sqrt(((cos(eta_c) * H * H - 0.1e1) * cos(phi_c) - sin(phi_c) * (cos(eta_c) + 0.1e1) * H + H * H + 0.1e1) * rf * rf) * sqrt(0.2e1);
	l2 = sqrt(0.4e1) * sqrt((sin(eta_c) * (cos(phi_c) * H + H + sin(phi_c) / 0.2e1) * sqrt(0.3e1) / 0.2e1 + (cos(eta_c) * H * H - 0.1e1 / 0.4e1) * cos(phi_c) + sin(phi_c) * (cos(eta_c) + 0.1e1) * H / 0.2e1 + H * H - 0.3e1 / 0.4e1 * cos(eta_c) + 0.1e1) * rf * rf) * sqrt(0.2e1) / 0.2e1;
	l3 = sqrt(0.4e1) * sqrt(rf * rf * (-sin(eta_c) * (cos(phi_c) * H + H + sin(phi_c) / 0.2e1) * sqrt(0.3e1) / 0.2e1 + (cos(eta_c) * H * H - 0.1e1 / 0.4e1) * cos(phi_c) + sin(phi_c) * (cos(eta_c) + 0.1e1) * H / 0.2e1 + H * H - 0.3e1 / 0.4e1 * cos(eta_c) + 0.1e1)) * sqrt(0.2e1) / 0.2e1;

	*theta1 = (l1 - HOME)/PULLEY_RAD;
	*theta2 = (l2 - HOME)/PULLEY_RAD;
	*theta3 = (l3 - HOME)/PULLEY_RAD;
	
	l1d = pow(((cos(eta_c) * H * H - 0.1e1) * cos(phi_c) - sin(phi_c) * (cos(eta_c) + 0.1e1) * H + H * H + 0.1e1) * rf * rf, -0.1e1 / 0.2e1) * sqrt(0.2e1) * (-H * H * sin(eta_c) * cos(phi_c) + sin(phi_c) * sin(eta_c) * H) * rf * rf * etad_c / 0.2e1 + pow(((cos(eta_c) * H * H - 0.1e1) * cos(phi_c) - sin(phi_c) * (cos(eta_c) + 0.1e1) * H + H * H + 0.1e1) * rf * rf, -0.1e1 / 0.2e1) * sqrt(0.2e1) * (-(cos(eta_c) * H * H - 0.1e1) * sin(phi_c) - H * (cos(eta_c) + 0.1e1) * cos(phi_c)) * rf * rf * phid_c / 0.2e1;
	l2d = sqrt(0.4e1) * pow((sin(eta_c) * (cos(phi_c) * H + H + sin(phi_c) / 0.2e1) * sqrt(0.3e1) / 0.2e1 + (cos(eta_c) * H * H - 0.1e1 / 0.4e1) * cos(phi_c) + sin(phi_c) * (cos(eta_c) + 0.1e1) * H / 0.2e1 + H * H - 0.3e1 / 0.4e1 * cos(eta_c) + 0.1e1) * rf * rf, -0.1e1 / 0.2e1) * sqrt(0.2e1) * ((cos(phi_c) * H + H + sin(phi_c) / 0.2e1) * cos(eta_c) * sqrt(0.3e1) / 0.2e1 - H * H * sin(eta_c) * cos(phi_c) - sin(phi_c) * sin(eta_c) * H / 0.2e1 + 0.3e1 / 0.4e1 * sin(eta_c)) * rf * rf * etad_c / 0.4e1 + sqrt(0.4e1) * pow((sin(eta_c) * (cos(phi_c) * H + H + sin(phi_c) / 0.2e1) * sqrt(0.3e1) / 0.2e1 + (cos(eta_c) * H * H - 0.1e1 / 0.4e1) * cos(phi_c) + sin(phi_c) * (cos(eta_c) + 0.1e1) * H / 0.2e1 + H * H - 0.3e1 / 0.4e1 * cos(eta_c) + 0.1e1) * rf * rf, -0.1e1 / 0.2e1) * sqrt(0.2e1) * (sin(eta_c) * (-sin(phi_c) * H + cos(phi_c) / 0.2e1) * sqrt(0.3e1) / 0.2e1 - sin(phi_c) * (cos(eta_c) * H * H - 0.1e1 / 0.4e1) + H * (cos(eta_c) + 0.1e1) * cos(phi_c) / 0.2e1) * rf * rf * phid_c / 0.4e1;
	l3d = sqrt(0.4e1) * pow(rf * rf * (-sin(eta_c) * (cos(phi_c) * H + H + sin(phi_c) / 0.2e1) * sqrt(0.3e1) / 0.2e1 + (cos(eta_c) * H * H - 0.1e1 / 0.4e1) * cos(phi_c) + sin(phi_c) * (cos(eta_c) + 0.1e1) * H / 0.2e1 + H * H - 0.3e1 / 0.4e1 * cos(eta_c) + 0.1e1), -0.1e1 / 0.2e1) * sqrt(0.2e1) * rf * rf * (-(cos(phi_c) * H + H + sin(phi_c) / 0.2e1) * cos(eta_c) * sqrt(0.3e1) / 0.2e1 - H * H * sin(eta_c) * cos(phi_c) - sin(phi_c) * sin(eta_c) * H / 0.2e1 + 0.3e1 / 0.4e1 * sin(eta_c)) * etad_c / 0.4e1 + sqrt(0.4e1) * pow(rf * rf * (-sin(eta_c) * (cos(phi_c) * H + H + sin(phi_c) / 0.2e1) * sqrt(0.3e1) / 0.2e1 + (cos(eta_c) * H * H - 0.1e1 / 0.4e1) * cos(phi_c) + sin(phi_c) * (cos(eta_c) + 0.1e1) * H / 0.2e1 + H * H - 0.3e1 / 0.4e1 * cos(eta_c) + 0.1e1), -0.1e1 / 0.2e1) * sqrt(0.2e1) * rf * rf * (-sin(eta_c) * (-sin(phi_c) * H + cos(phi_c) / 0.2e1) * sqrt(0.3e1) / 0.2e1 - sin(phi_c) * (cos(eta_c) * H * H - 0.1e1 / 0.4e1) + H * (cos(eta_c) + 0.1e1) * cos(phi_c) / 0.2e1) * phid_c / 0.4e1;
	
	*theta1d = l1d/PULLEY_RAD;
	*theta2d = l2d/PULLEY_RAD;
	*theta3d = l3d/PULLEY_RAD;
	
	v1 = (-pow(((cos(eta_c) * H * H - 0.1e1) * cos(phi_c) - sin(phi_c) * (cos(eta_c) + 0.1e1) * H - H * H + 0.1e1) * rf * rf, -0.3e1 / 0.2e1) * sqrt(0.2e1) * pow(-H * H * sin(eta_c) * cos(phi_c) + sin(phi_c) * sin(eta_c) * H, 0.2e1) * pow(rf, 0.4e1) / 0.4e1 + pow(((cos(eta_c) * H * H - 0.1e1) * cos(phi_c) - sin(phi_c) * (cos(eta_c) + 0.1e1) * H - H * H + 0.1e1) * rf * rf, -0.1e1 / 0.2e1) * sqrt(0.2e1) * (-cos(phi_c) * cos(eta_c) * H * H + sin(phi_c) * cos(eta_c) * H) * rf * rf / 0.2e1) * etad_c + (-pow(((cos(eta_c) * H * H - 0.1e1) * cos(phi_c) - sin(phi_c) * (cos(eta_c) + 0.1e1) * H - H * H + 0.1e1) * rf * rf, -0.3e1 / 0.2e1) * sqrt(0.2e1) * pow(-(cos(eta_c) * H * H - 0.1e1) * sin(phi_c) - H * (cos(eta_c) + 0.1e1) * cos(phi_c), 0.2e1) * pow(rf, 0.4e1) / 0.4e1 + pow(((cos(eta_c) * H * H - 0.1e1) * cos(phi_c) - sin(phi_c) * (cos(eta_c) + 0.1e1) * H - H * H + 0.1e1) * rf * rf, -0.1e1 / 0.2e1) * sqrt(0.2e1) * (-(cos(eta_c) * H * H - 0.1e1) * cos(phi_c) + sin(phi_c) * (cos(eta_c) + 0.1e1) * H) * rf * rf / 0.2e1) * phid_c;
	v2 = (-sqrt(0.4e1) * pow((sin(eta_c) * (cos(phi_c) * H - H + sin(phi_c) / 0.2e1) * sqrt(0.3e1) / 0.2e1 + (cos(eta_c) * H * H - 0.1e1 / 0.4e1) * cos(phi_c) + sin(phi_c) * (cos(eta_c) + 0.1e1) * H / 0.2e1 - H * H - 0.3e1 / 0.4e1 * cos(eta_c) + 0.1e1) * rf * rf, -0.3e1 / 0.2e1) * sqrt(0.2e1) * pow((cos(phi_c) * H - H + sin(phi_c) / 0.2e1) * cos(eta_c) * sqrt(0.3e1) / 0.2e1 - H * H * sin(eta_c) * cos(phi_c) - sin(phi_c) * sin(eta_c) * H / 0.2e1 + 0.3e1 / 0.4e1 * sin(eta_c), 0.2e1) * pow(rf, 0.4e1) / 0.8e1 + sqrt(0.4e1) * pow((sin(eta_c) * (cos(phi_c) * H - H + sin(phi_c) / 0.2e1) * sqrt(0.3e1) / 0.2e1 + (cos(eta_c) * H * H - 0.1e1 / 0.4e1) * cos(phi_c) + sin(phi_c) * (cos(eta_c) + 0.1e1) * H / 0.2e1 - H * H - 0.3e1 / 0.4e1 * cos(eta_c) + 0.1e1) * rf * rf, -0.1e1 / 0.2e1) * sqrt(0.2e1) * (-sin(eta_c) * (cos(phi_c) * H - H + sin(phi_c) / 0.2e1) * sqrt(0.3e1) / 0.2e1 - cos(phi_c) * cos(eta_c) * H * H - sin(phi_c) * cos(eta_c) * H / 0.2e1 + 0.3e1 / 0.4e1 * cos(eta_c)) * rf * rf / 0.4e1) * etad_c + (-sqrt(0.4e1) * pow((sin(eta_c) * (cos(phi_c) * H - H + sin(phi_c) / 0.2e1) * sqrt(0.3e1) / 0.2e1 + (cos(eta_c) * H * H - 0.1e1 / 0.4e1) * cos(phi_c) + sin(phi_c) * (cos(eta_c) + 0.1e1) * H / 0.2e1 - H * H - 0.3e1 / 0.4e1 * cos(eta_c) + 0.1e1) * rf * rf, -0.3e1 / 0.2e1) * sqrt(0.2e1) * pow(sin(eta_c) * (-sin(phi_c) * H + cos(phi_c) / 0.2e1) * sqrt(0.3e1) / 0.2e1 - sin(phi_c) * (cos(eta_c) * H * H - 0.1e1 / 0.4e1) - H * (cos(eta_c) + 0.1e1) * cos(phi_c) / 0.2e1, 0.2e1) * pow(rf, 0.4e1) / 0.8e1 + sqrt(0.4e1) * pow((sin(eta_c) * (cos(phi_c) * H - H + sin(phi_c) / 0.2e1) * sqrt(0.3e1) / 0.2e1 + (cos(eta_c) * H * H - 0.1e1 / 0.4e1) * cos(phi_c) + sin(phi_c) * (cos(eta_c) + 0.1e1) * H / 0.2e1 - H * H - 0.3e1 / 0.4e1 * cos(eta_c) + 0.1e1) * rf * rf, -0.1e1 / 0.2e1) * sqrt(0.2e1) * (sin(eta_c) * (-cos(phi_c) * H - sin(phi_c) / 0.2e1) * sqrt(0.3e1) / 0.2e1 - (cos(eta_c) * H * H - 0.1e1 / 0.4e1) * cos(phi_c) - sin(phi_c) * (cos(eta_c) + 0.1e1) * H / 0.2e1) * rf * rf / 0.4e1) * phid_c;
	v3 = (-sqrt(0.4e1) * pow(rf * rf * (-sin(eta_c) * (cos(phi_c) * H - H + sin(phi_c) / 0.2e1) * sqrt(0.3e1) / 0.2e1 + (cos(eta_c) * H * H - 0.1e1 / 0.4e1) * cos(phi_c) + sin(phi_c) * (cos(eta_c) + 0.1e1) * H / 0.2e1 - H * H - 0.3e1 / 0.4e1 * cos(eta_c) + 0.1e1), -0.3e1 / 0.2e1) * sqrt(0.2e1) * pow(rf, 0.4e1) * pow(-(cos(phi_c) * H - H + sin(phi_c) / 0.2e1) * cos(eta_c) * sqrt(0.3e1) / 0.2e1 - H * H * sin(eta_c) * cos(phi_c) - sin(phi_c) * sin(eta_c) * H / 0.2e1 + 0.3e1 / 0.4e1 * sin(eta_c), 0.2e1) / 0.8e1 + sqrt(0.4e1) * pow(rf * rf * (-sin(eta_c) * (cos(phi_c) * H - H + sin(phi_c) / 0.2e1) * sqrt(0.3e1) / 0.2e1 + (cos(eta_c) * H * H - 0.1e1 / 0.4e1) * cos(phi_c) + sin(phi_c) * (cos(eta_c) + 0.1e1) * H / 0.2e1 - H * H - 0.3e1 / 0.4e1 * cos(eta_c) + 0.1e1), -0.1e1 / 0.2e1) * sqrt(0.2e1) * rf * rf * (sin(eta_c) * (cos(phi_c) * H - H + sin(phi_c) / 0.2e1) * sqrt(0.3e1) / 0.2e1 - cos(phi_c) * cos(eta_c) * H * H - sin(phi_c) * cos(eta_c) * H / 0.2e1 + 0.3e1 / 0.4e1 * cos(eta_c)) / 0.4e1) * etad_c + (-sqrt(0.4e1) * pow(rf * rf * (-sin(eta_c) * (cos(phi_c) * H - H + sin(phi_c) / 0.2e1) * sqrt(0.3e1) / 0.2e1 + (cos(eta_c) * H * H - 0.1e1 / 0.4e1) * cos(phi_c) + sin(phi_c) * (cos(eta_c) + 0.1e1) * H / 0.2e1 - H * H - 0.3e1 / 0.4e1 * cos(eta_c) + 0.1e1), -0.3e1 / 0.2e1) * sqrt(0.2e1) * pow(rf, 0.4e1) * pow(-sin(eta_c) * (-sin(phi_c) * H + cos(phi_c) / 0.2e1) * sqrt(0.3e1) / 0.2e1 - sin(phi_c) * (cos(eta_c) * H * H - 0.1e1 / 0.4e1) - H * (cos(eta_c) + 0.1e1) * cos(phi_c) / 0.2e1, 0.2e1) / 0.8e1 + sqrt(0.4e1) * pow(rf * rf * (-sin(eta_c) * (cos(phi_c) * H - H + sin(phi_c) / 0.2e1) * sqrt(0.3e1) / 0.2e1 + (cos(eta_c) * H * H - 0.1e1 / 0.4e1) * cos(phi_c) + sin(phi_c) * (cos(eta_c) + 0.1e1) * H / 0.2e1 - H * H - 0.3e1 / 0.4e1 * cos(eta_c) + 0.1e1), -0.1e1 / 0.2e1) * sqrt(0.2e1) * rf * rf * (-sin(eta_c) * (-cos(phi_c) * H - sin(phi_c) / 0.2e1) * sqrt(0.3e1) / 0.2e1 - (cos(eta_c) * H * H - 0.1e1 / 0.4e1) * cos(phi_c) - sin(phi_c) * (cos(eta_c) + 0.1e1) * H / 0.2e1) / 0.4e1) * phid_c;
	
	a1= pow(((cos(eta_c) * H * H - 0.1e1) * cos(phi_c) - sin(phi_c) * (cos(eta_c) + 0.1e1) * H - H * H + 0.1e1) * rf * rf, -0.1e1 / 0.2e1) * sqrt(0.2e1) * (-H * H * sin(eta_c) * cos(phi_c) + sin(phi_c) * sin(eta_c) * H) * rf * rf * etadd_c / 0.2e1 + pow(((cos(eta_c) * H * H - 0.1e1) * cos(phi_c) - sin(phi_c) * (cos(eta_c) + 0.1e1) * H - H * H + 0.1e1) * rf * rf, -0.1e1 / 0.2e1) * sqrt(0.2e1) * (-(cos(eta_c) * H * H - 0.1e1) * sin(phi_c) - H * (cos(eta_c) + 0.1e1) * cos(phi_c)) * rf * rf * phidd_c / 0.2e1;
	a2= sqrt(0.4e1) * pow((sin(eta_c) * (cos(phi_c) * H - H + sin(phi_c) / 0.2e1) * sqrt(0.3e1) / 0.2e1 + (cos(eta_c) * H * H - 0.1e1 / 0.4e1) * cos(phi_c) + sin(phi_c) * (cos(eta_c) + 0.1e1) * H / 0.2e1 - H * H - 0.3e1 / 0.4e1 * cos(eta_c) + 0.1e1) * rf * rf, -0.1e1 / 0.2e1) * sqrt(0.2e1) * ((cos(phi_c) * H - H + sin(phi_c) / 0.2e1) * cos(eta_c) * sqrt(0.3e1) / 0.2e1 - H * H * sin(eta_c) * cos(phi_c) - sin(phi_c) * sin(eta_c) * H / 0.2e1 + 0.3e1 / 0.4e1 * sin(eta_c)) * rf * rf * etadd_c / 0.4e1 + sqrt(0.4e1) * pow((sin(eta_c) * (cos(phi_c) * H - H + sin(phi_c) / 0.2e1) * sqrt(0.3e1) / 0.2e1 + (cos(eta_c) * H * H - 0.1e1 / 0.4e1) * cos(phi_c) + sin(phi_c) * (cos(eta_c) + 0.1e1) * H / 0.2e1 - H * H - 0.3e1 / 0.4e1 * cos(eta_c) + 0.1e1) * rf * rf, -0.1e1 / 0.2e1) * sqrt(0.2e1) * (sin(eta_c) * (-sin(phi_c) * H + cos(phi_c) / 0.2e1) * sqrt(0.3e1) / 0.2e1 - sin(phi_c) * (cos(eta_c) * H * H - 0.1e1 / 0.4e1) - H * (cos(eta_c) + 0.1e1) * cos(phi_c) / 0.2e1) * rf * rf * phidd_c / 0.4e1;
	a3= sqrt(0.4e1) * pow(rf * rf * (-sin(eta_c) * (cos(phi_c) * H - H + sin(phi_c) / 0.2e1) * sqrt(0.3e1) / 0.2e1 + (cos(eta_c) * H * H - 0.1e1 / 0.4e1) * cos(phi_c) + sin(phi_c) * (cos(eta_c) + 0.1e1) * H / 0.2e1 - H * H - 0.3e1 / 0.4e1 * cos(eta_c) + 0.1e1), -0.1e1 / 0.2e1) * sqrt(0.2e1) * rf * rf * (-(cos(phi_c) * H - H + sin(phi_c) / 0.2e1) * cos(eta_c) * sqrt(0.3e1) / 0.2e1 - H * H * sin(eta_c) * cos(phi_c) - sin(phi_c) * sin(eta_c) * H / 0.2e1 + 0.3e1 / 0.4e1 * sin(eta_c)) * etadd_c / 0.4e1 + sqrt(0.4e1) * pow(rf * rf * (-sin(eta_c) * (cos(phi_c) * H - H + sin(phi_c) / 0.2e1) * sqrt(0.3e1) / 0.2e1 + (cos(eta_c) * H * H - 0.1e1 / 0.4e1) * cos(phi_c) + sin(phi_c) * (cos(eta_c) + 0.1e1) * H / 0.2e1 - H * H - 0.3e1 / 0.4e1 * cos(eta_c) + 0.1e1), -0.1e1 / 0.2e1) * sqrt(0.2e1) * rf * rf * (-sin(eta_c) * (-sin(phi_c) * H + cos(phi_c) / 0.2e1) * sqrt(0.3e1) / 0.2e1 - sin(phi_c) * (cos(eta_c) * H * H - 0.1e1 / 0.4e1) - H * (cos(eta_c) + 0.1e1) * cos(phi_c) / 0.2e1) * phidd_c / 0.4e1;
	
	*theta1dd = (v1+a1)/PULLEY_RAD;
	*theta2dd = (v2+a2)/PULLEY_RAD;
	*theta3dd = (v3+a3)/PULLEY_RAD;
	
}
	
	
	

	

